{% load i18n static jazzmin admin_list %}
{% if cl and cl.paginator and cl.paginator.num_pages > 1 %}
    {% with page_num=cl.page_num|default:1 page_var=cl.page_var|default:'p' %}
        <ul class="pagination pagination-sm m-0 float-right">
            {% comment %} Previous page link {% endcomment %}
            <li class="page-item {% if page_num <= 1 %}disabled{% endif %}">
                <a href="?{{ page_var }}={% if page_num > 1 %}{{ page_num|add:'-1' }}{% else %}1{% endif %}{% if cl.is_popup %}&_popup=1{% endif %}{% if cl.search_url %}&{{ cl.search_url }}{% endif %}" 
                   class="page-link" 
                   aria-label="{% trans 'Previous' %}">
                    <span aria-hidden="true">«</span>
                </a>
            </li>

            {% comment %} First page and ellipsis {% endcomment %}
            {% if page_num > 3 %}
                <li class="page-item">
                    <a href="?{{ page_var }}=1{% if cl.is_popup %}&_popup=1{% endif %}{% if cl.search_url %}&{{ cl.search_url }}{% endif %}" 
                       class="page-link">1</a>
                </li>
                {% if page_num > 4 %}
                    <li class="page-item disabled">
                        <span class="page-link">…</span>
                    </li>
                {% endif %}
            {% endif %}

            {% comment %} Page numbers around current page {% endcomment %}
            {% for i in cl.paginator.page_range %}
                {% if i >= page_num|add:'-2' and i <= page_num|add:'2' %}
                    <li class="page-item {% if i == page_num %}active{% endif %}">
                        <a href="?{{ page_var }}={{ i }}{% if cl.is_popup %}&_popup=1{% endif %}{% if cl.search_url %}&{{ cl.search_url }}{% endif %}" 
                           class="page-link">
                            {{ i }}
                            {% if i == page_num %}<span class="sr-only">(current)</span>{% endif %}
                        </a>
                    </li>
                {% endif %}
            {% endfor %}

            {% comment %} Last page and ellipsis {% endcomment %}
            {% if page_num < cl.paginator.num_pages|add:'-2' %}
                {% if page_num < cl.paginator.num_pages|add:'-3' %}
                    <li class="page-item disabled">
                        <span class="page-link">…</span>
                    </li>
                {% endif %}
                <li class="page-item">
                    <a href="?{{ page_var }}={{ cl.paginator.num_pages }}{% if cl.is_popup %}&_popup=1{% endif %}{% if cl.search_url %}&{{ cl.search_url }}{% endif %}" 
                       class="page-link">{{ cl.paginator.num_pages }}</a>
                </li>
            {% endif %}

            {% comment %} Next page link {% endcomment %}
            <li class="page-item {% if page_num >= cl.paginator.num_pages %}disabled{% endif %}">
                <a href="?{{ page_var }}={% if page_num < cl.paginator.num_pages %}{{ page_num|add:'1' }}{% else %}{{ cl.paginator.num_pages }}{% endif %}{% if cl.is_popup %}&_popup=1{% endif %}{% if cl.search_url %}&{{ cl.search_url }}{% endif %}" 
                   class="page-link" 
                   aria-label="{% trans 'Next' %}">
                    <span aria-hidden="true">»</span>
                </a>
            </li>
        </ul>
    {% endwith %}
{% endif %}
